<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Blog Atom Feed"><title data-react-helmet="true">git 儲存資料方式和儲存空間 | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://eklipsorz.info/howToUseGit/gitStorage"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="git 儲存資料方式和儲存空間 | My Site"><meta data-react-helmet="true" name="description" content="在本文章會直接論述著git是如何儲存每一次版本的資料以及它所擁有的儲存空間有那些，前者會在第一小節描述，後者則由第二小節來描述。"><meta data-react-helmet="true" property="og:description" content="在本文章會直接論述著git是如何儲存每一次版本的資料以及它所擁有的儲存空間有那些，前者會在第一小節描述，後者則由第二小節來描述。"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://eklipsorz.info/howToUseGit/gitStorage"><link data-react-helmet="true" rel="alternate" href="https://eklipsorz.info/howToUseGit/gitStorage" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://eklipsorz.info/howToUseGit/gitStorage" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.b697c4a6.css">
<link rel="preload" href="/assets/js/runtime~main.4a79af59.js" as="script">
<link rel="preload" href="/assets/js/main.f16c70e7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">dev-wiki</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AC Semester 2-2</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">How to use git</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/howToUseGit/generalCMD">常見指令</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/howToUseGit/remoteRepoManage">遠端倉庫常用指令</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/howToUseGit/gitStorage">git 儲存資料方式和儲存空間</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/howToUseGit/gitFileStatus">git 系統中的檔案狀態</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/howToUseGit/howToCommit">提交版本準則</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/howToUseGit/mergeCMD">進階指令 - git merge</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/howToUseGit/rebaseCMD">進階指令 - git rebase</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/howToUseGit/CMDDifference">Reset、Rebase、Revert三者不同</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/howToUseGit/otherKnowledge">待分類知識</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>git 儲存資料方式和儲存空間</h1></header><p>在本文章會直接論述著git是如何儲存每一次版本的資料以及它所擁有的儲存空間有那些，前者會在第一小節描述，後者則由第二小節來描述。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="git-儲存資料的方式"></a>git 儲存資料的方式<a class="hash-link" href="#git-儲存資料的方式" title="Direct link to heading">#</a></h2><p>git 不像其他版本控制系統那樣，每個版本只單純存放修改內容，當要到指定版本時便會匯集以及處理來達成，git會使用snapshot技術來存放每一次版本內容，而這個snapshot技術則是以File snapshot作為基礎來修改，所以在這小節中會先以File snapshot來說明，並且再正式描述git snapshot本身是什麼。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="file-snapshot"></a>File Snapshot<a class="hash-link" href="#file-snapshot" title="Direct link to heading">#</a></h3><p>File snapshot是針對一個檔案來紀錄它在不同時間點下的內容紀錄，每一個時間點下的檔案內容都會被紀錄，而這些內容又如同紀錄某個時段的相片(snapshot)，故稱之為snapshot，但由於這項技術是紀錄特定檔案在不同時間點的內容，所以若只是單純採用複製的方法來實現，會造成系統很多負擔，而且這些內容大部分都是重複的，所以會採取內容共享的手段來大幅度減少系統負擔，我們以一個例子來說明，在這裡我們建立一個名為File 1的檔案內容，其內容會直接以類似by reference或者指標的形式指向
在硬碟(Disk)的實際內容。</p><p><img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632575615/blog/git/anExample_createFile1_l14ho0.png"></p><p>而當我們對File 1進行所謂共享來獲取snapshot時，會生成另一個名為File 2檔案(名稱可以是同名)，其內容會直接以類似於by reference方式或者以指標的形式來指向File 1檔案內容的記憶體位址所在，</p><p><img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632575634/blog/git/anExample_snapshot_lm3qcm.png"></p><p>讓File 2不用再向系統要一塊硬碟空間去存放File1 內容，而是直接像上圖那樣，兩個檔案都共享著同個內容，對於File 1而言， File 2 是以File 1的內容作為snapshot來進行相關的修改</p><p><img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632575959/blog/git/anExample_copyfile_iovmhc.png"></p><p>當File 2想要對共享內容做變更時，系統會以copy on write的形式來向系統要塊硬碟空間去存放這些變更內容，而非整塊檔案內容，在這裡File 2內容還是會仍指向存放File 1內容的硬碟位址，但會增加名為Changes的指標去指向存放變更內容的硬碟區塊，同樣地，File 1本身也能做這樣子的更改。</p><p><img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632576922/blog/git/anExample_copyonwrite_scoduu.png"></p><p>若還有第三個檔案File 3的話，那就要考慮它以什麼檔案內容來當snapshot，若還是把File 1的檔案內容當作snapshot的話，原則上會如同File 2那樣共享File 1內容並存放變更內容，但若是以File 2為主的話，File 3的內容會指向File 2所指向的內容以及它所修改的內容，而File 3的變更內容則是指向存放對File 2進行變更的內容之硬碟區塊。若還有其他檔案如同File 3那樣延續著以前一個檔案來當作snapshot來修改的話，會如同File 3來指向。</p><p><img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632578989/blog/git/anotherExample_copyonwrite_uexl15.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="git-snapshot"></a>git snapshot<a class="hash-link" href="#git-snapshot" title="Direct link to heading">#</a></h3><p>git在repo存放的每一個版本的資料形式會是以類似於file snapshot的形式來進行，每一個版本會是以前一個版本作為snapshot來修改，我們以一個例子來說明，首先我們先建立一個repo並放入三個檔案，分別為File 1、File 2、File 3，接著對他們進行add和commit來提交第一次的版本，儲存形式會是以完整檔案來存放，接著當我們對著三個檔案做了一些小修改時，並且add以及commit來提交第二次的版本，這時第二次的版本內容將不會是以完整內容來存放，每個檔案有分為snapshot以及Changes((snapshot 和 Changes 並非git真以這名稱來說明，在這裡是方便解釋，但概念上是一樣的)，而snapshot會直接指向前一個版本內容的位置，也就是指向第一個版本的內容，而每個檔案都會指向第一個版本的對應檔案，而Changes則是存放著這次版本修改的內容。</p><p><img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632579687/blog/git/anExampleOfGitsnapshot_pjz1z2.png"></p><p>若有檔案沒在第二次版本做任何修改的話，會如同下圖中的第二個檔案那樣，只會有指向前一個版本內容的snapshot。</p><p><img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632580141/blog/git/Gitsnapshot_file2nochange_y1ixl8.png"></p><p>接著若我們繼續對三個檔案進行修改的話，並且提交第三次的版本，這時的版本內容將會以第二個版本內容為主，第三個版本下每個檔案的snapshot會是以第二個版本所指向的snapshot以及第二個版本的修改內容，而第三個版本的修改內容會以Changes來存放，拿File 1來說的話，File 1的snapshot會以第二版本的File 1作為snapshot來修改。
<img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632580274/blog/git/Gitsnapshot_threeVersions_yg2es2.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="git系統本地端空間"></a>git系統：本地端空間<a class="hash-link" href="#git系統本地端空間" title="Direct link to heading">#</a></h2><p>當在本地端透過git init或者利用git clone來產生一個新repo時，會以存放.git目錄作為repo的根目錄，而這個根目錄和其下檔案/目錄皆稱為工作目錄(working directory/working tree)，每當在目錄下對某些內容下達git add時，會將內容存放暫存區(Staging area)，接著當下達git commit時，便會將暫存區的內容以一個版本的形式去提交/上傳至倉庫(Repository, repo)。 而工作目錄、暫存區、倉庫會是本地端的git 系統所會擁有的儲存空間，在這小節中，會以上面的描述為基礎來稍微詳細說明每種的用途以及他們是什麼。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="working-directory"></a>Working directory<a class="hash-link" href="#working-directory" title="Direct link to heading">#</a></h3><ol><li>當我們下達git init 來建立repo或者利用git clone來獲取repo時，不論是哪一種都會有.git這隱藏目錄，而git系統會以這個隱藏目錄所在的目錄作為它的工作目錄</li><li>在這個工作目錄下，可以允許存放未被git追蹤的檔案，換言之，即使沒下達git add，任意的檔案都能存放在這個目錄下</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="staging-area"></a>Staging area<a class="hash-link" href="#staging-area" title="Direct link to heading">#</a></h3><ol><li>英文意思為(軍人的)集結區域，在這裡同樣地，這區塊也是集結著一些要準備提交/上傳的內容，提交/上傳的目的會是本地端的repo，而這個區域也可已被稱之為暫存區</li><li>每一個工作目錄下都擁有各自的暫存區、倉庫，換言之，n個工作目錄下的暫存區和倉庫都是彼此獨立的，不會是一樣的內容，更別說彼此會相互影響。</li><li>當在工作目錄對某些內容下達git add時，系統會先檢查這些內容是不是目前最新版本的內容，若不是的話，才會被複製並存放至暫存區，否則就不會放入該暫存區。</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="repository"></a>Repository<a class="hash-link" href="#repository" title="Direct link to heading">#</a></h3><ol><li>英文意思為倉庫，會存放不同時期下的版本內容或者提交內容</li><li>每一個工作目錄下都擁有各自的暫存區、倉庫</li><li>當對工作目錄下達git commit時，便會把該目錄下所擁有的暫存區以版本的形式來提交/上傳至倉庫，而這個倉庫會是這個工作目錄所擁有的倉庫。此時的暫存區會被清空。</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="例子"></a>例子<a class="hash-link" href="#例子" title="Direct link to heading">#</a></h3><p>在這裡我們以一個小例子來描述這三種主要儲存空間，同樣地，當我們下達git init 來建立repo或者利用git clone來獲取repo時，此時repo會是以目錄來表示，這時我們只需要進去該目錄，而這個目錄會是一個工作目錄，裡頭放了.git隱藏目錄以及一些內容(如下圖所示)
<img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632562546/blog/git/anExample1OfGitStorage_nqnzun.png"></p><p>若我們對著這些檔案下達git add時，系統會先去拿倉庫的最新版本內容來比對這些要加入至暫存區的內容，比對結果是不一致的話，才會複製其內容並放入暫存區，若一致則不會複製以及不會做放入暫存區的動作。在這裡，我們就先以不一致的情況下來說明
<img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632562545/blog/git/anExample2OfGitStorage_s1tpcw.png"></p><p>當對這個工作目錄下達git commit時，系統會以一個版本的形式來將暫存區的內容搬移至repo，而此時的暫存區會被清空。
<img src="https://res.cloudinary.com/dqfxgtyoi/image/upload/v1632562545/blog/git/anExample3OfGitStorage_gqcrun.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="git系統遠端空間"></a>git系統：遠端空間<a class="hash-link" href="#git系統遠端空間" title="Direct link to heading">#</a></h2><p>由外部提供git服務的伺服器所提供的空間，該空間通常會以Repository的形式來存放資料，也可以稱之為Remote Repository，並且允許使用者上傳自己在本地端上的git Repository至伺服器所提供的空間從而讓更多使用者下載共享這份Respository，甚至可以利用其服務來更新遠端倉庫的內容，而這也是git分散式版本控制的核心部分，通常提供這服務的知名服務有github、gitlab等等。另外git本身帶有一組指令能夠從本地端控管遠端倉庫的設定、內容更新/刪除等等等</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/docs/howToUseGit/gitStorage.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/howToUseGit/remoteRepoManage"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 遠端倉庫常用指令</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/howToUseGit/gitFileStatus"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">git 系統中的檔案狀態 »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#git-儲存資料的方式" class="table-of-contents__link">git 儲存資料的方式</a><ul><li><a href="#file-snapshot" class="table-of-contents__link">File Snapshot</a></li><li><a href="#git-snapshot" class="table-of-contents__link">git snapshot</a></li></ul></li><li><a href="#git系統本地端空間" class="table-of-contents__link">git系統：本地端空間</a><ul><li><a href="#working-directory" class="table-of-contents__link">Working directory</a></li><li><a href="#staging-area" class="table-of-contents__link">Staging area</a></li><li><a href="#repository" class="table-of-contents__link">Repository</a></li><li><a href="#例子" class="table-of-contents__link">例子</a></li></ul></li><li><a href="#git系統遠端空間" class="table-of-contents__link">git系統：遠端空間</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4a79af59.js"></script>
<script src="/assets/js/main.f16c70e7.js"></script>
</body>
</html>